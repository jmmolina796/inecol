$.fn.imagesLoaded=function(){var a=this.find('img[src!=""]');if(!a.length)return $.Deferred().resolve().promise();var b=[];return a.each(function(){var a=$.Deferred();b.push(a);var c=new Image;c.onload=function(){a.resolve()},c.onerror=function(){a.resolve()},c.src=this.src}),$.when.apply($,b)};